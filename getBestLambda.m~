function [bestTheta, bestLambda, bestCost, lambdaVSTrainingAndValidation] = getBestLambda( trainingX, validationX, trainingY, validationY)

    bestLambda = 3^(-10);
    bestTheta = [];
    bestCost = 99999;
    
    [m,n] = size(trainingX);
    
    for lambda = linspace(3^(-5),3^(5))
        initial_theta = zeros(n, 1);
        
        options = optimset('GradObj', 'on', 'MaxIter', 2000);
        [theta, cost, exit_flag] = fminunc(@(t)(costFunctionReg(t, trainingX, trainingY, lambda)), initial_theta, options);
        
        if bestCost > cost
            bestCost = cost;
            bestTheta = theta;
            bestLambda = lambda;
        end
        
        lambdaVSTrainingAndValidation = [lambdaVSTrainingAndValidation; ...
            [ lambda, getAccuracy(trainingX, trainingY, theta), getAccuracy(validationX, validationY, theta)] ];
    end

end